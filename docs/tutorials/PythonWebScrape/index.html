
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://hbs-rcs.github.io/hbsgrid-docs/tutorials/PythonWebScrape/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.11">
    
    
      
        <title>Web Scraping in Python - HBS Grid Software Environments Technology Preview User Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50e68009.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="hbs" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-web-scraping" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="HBS Grid Software Environments Technology Preview User Guide" class="md-header__button md-logo" aria-label="HBS Grid Software Environments Technology Preview User Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HBS Grid Software Environments Technology Preview User Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Web Scraping in Python
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hbs-rcs/hbsgrid-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../userguide/quickstart/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../usecases/" class="md-tabs__link md-tabs__link--active">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../support/trouble/" class="md-tabs__link">
        Support
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../blog/" class="md-tabs__link">
      Blog
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="HBS Grid Software Environments Technology Preview User Guide" class="md-nav__button md-logo" aria-label="HBS Grid Software Environments Technology Preview User Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    HBS Grid Software Environments Technology Preview User Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hbs-rcs/hbsgrid-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/quickstart/" class="md-nav__link">
        ⮊ &nbsp;&nbsp;Get Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/menulaunch/" class="md-nav__link">
        🚀 &nbsp;&nbsp;Run Desktop Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/syncfiles/" class="md-nav__link">
        🗘 &nbsp;&nbsp;Copy and Sync Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/worksafe/" class="md-nav__link">
        👥 &nbsp;&nbsp;Collaborate and Share
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/commandline/" class="md-nav__link">
        ┃> &nbsp;Use the Command-line
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/environments/" class="md-nav__link">
        📦 &nbsp;&nbsp;Use Software Versions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usecases/" class="md-nav__link">
         &nbsp; 
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../large_data_R/" class="md-nav__link">
        Large data in R
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Web Scraping in Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Web Scraping in Python
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#web-scraping-background" class="md-nav__link">
    Web scraping background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieve-data-in-json-format-if-you-can" class="md-nav__link">
    Retrieve data in JSON format if you can
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parsing-html-if-you-have-to" class="md-nav__link">
    Parsing HTML if you have to
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scrapy-for-large-complex-projects" class="md-nav__link">
    Scrapy: for large / complex projects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#browser-drivers-a-last-resort" class="md-nav__link">
    Browser drivers: a last resort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrap-up" class="md-nav__link">
    Wrap-up
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp_with_python/" class="md-nav__link">
        NLP in Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Support
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Support" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Support
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../support/trouble/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../support/requests/" class="md-nav__link">
        Account and Service Requests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../support/contact/" class="md-nav__link">
        Contact Us
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/hbs-rcs/hbsgrid-docs/discussions/" class="md-nav__link">
        Discussion Forum🔗
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/hbs-rcs/hbsgrid-docs/issues/" class="md-nav__link">
        Bug Reports🔗
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        Blog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/hbs-rcs/hbsgrid-docs/edit/main/source/tutorials/PythonWebScrape.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="python-web-scraping">Python Web-Scraping</h1>
<p>This is an intermediate / advanced Python tutorial:</p>
<ul>
<li>Assumes knowledge of Python, including:<ul>
<li>lists</li>
<li>dictionaries</li>
<li>logical indexing</li>
<li>iteration with for-loops</li>
</ul>
</li>
<li>Assumes basic knowledge of web page structure</li>
</ul>
<p>If you need an introduction to Python or a refresher, we recommend our
<a href="https://iqss.github.io/dss-workshops/PythonIntro.html">Python
Introduction</a>.</p>
<h3 id="goals">Goals</h3>
<div class="alert alert-success">

This workshop is organized into two main parts:

1.  Retrive information in JSON format
2.  Parse HTML files

Note that this workshop will not teach you everything you need to know
in order to retrieve data from any web service you might wish to scrape.

</div>

<h2 id="web-scraping-background">Web scraping background</h2>
<h3 id="what-is-web-scraping">What is web scraping?</h3>
<p>Web scraping is the activity of automating retrieval of information from
a web service designed for human interaction.</p>
<h3 id="is-web-scraping-legal-is-it-ethical">Is web scraping legal? Is it ethical?</h3>
<p>It depends. If you have legal questions seek legal counsel. You can
mitigate some ethical issues by building delays and restrictions into
your web scraping program so as to avoid impacting the availability of
the web service for other users or the cost of hosting the service for
the service provider.</p>
<h3 id="web-scraping-approaches">Web scraping approaches</h3>
<p>No two websites are identical — websites are built for different
purposes by different people and so have different underlying
structures. Because they are heterogeneous, there is no single way to
scrape a website. <strong>The scraping approach therefore has to be tailored
to each individual site.</strong> Here are some commonly used approaches:</p>
<ol>
<li>Use requests to extract information from structured JSON files</li>
<li>Use requests to extract information from HTML</li>
<li>Automate a browser to retrieve information from HTML</li>
</ol>
<p>Bear in mind that even once you’ve decided upon the best approach for a
particular site, it will be necessary to modify that approach to suit
your particular use-case.</p>
<h3 id="how-does-the-web-work">How does the web work?</h3>
<h4 id="components">Components</h4>
<p>Computers connected to the web are called <strong>clients</strong> and <strong>servers</strong>. A
simplified diagram of how they interact might look like this:</p>
<p><img alt="" src="../imgs/client_server.png" /></p>
<ul>
<li><strong>Clients</strong> are the typical web user’s internet-connected devices
    (for example, your computer connected to your Wi-Fi) and
    web-accessing software available on those devices (usually a web
    browser like Firefox or Chrome).</li>
<li><strong>Servers</strong> are computers that store webpages, sites, or apps. When
    a client device wants to access a webpage, a copy of the webpage is
    downloaded from the server onto the client machine to be displayed
    in the user’s web browser.</li>
<li><strong>HTTP</strong> is a language for clients and servers to speak to each
    other.</li>
</ul>
<h4 id="so-what-happens">So what happens?</h4>
<p>When you type a web address into your browser:</p>
<ol>
<li>The browser finds the address of the server that the website lives
    on.</li>
<li>The browser sends an <strong>HTTP request message</strong> to the server, asking
    it to send a copy of the website to the client.</li>
<li>If the server approves the client’s request, the server sends the
    client a <code>200 OK</code> message, and then starts displaying the website in
    the browser.</li>
</ol>
<h2 id="retrieve-data-in-json-format-if-you-can">Retrieve data in JSON format if you can</h2>
<div class="alert alert-info">

**GOAL: To retrieve information in JSON format and organize it into a
spreadsheet.**

1.  Inspect the website to check if the content is stored in JSON format
2.  Make a request to the website server to retrieve the JSON file
3.  Convert from JSON format into a Python dictionary
4.  Extract the data from the dictionary and store in a .csv file

</div>

<p>We wish to extract information from
<a href="https://www.harvardartmuseums.org/collections">https://www.harvardartmuseums.org/collections</a>. Like most modern web
pages, a lot goes on behind the scenes to produce the page we see in our
browser. Our goal is to pull back the curtain to see what the website
does when we interact with it. Once we see how the website works we can
start retrieving data from it.</p>
<p>If we are lucky we’ll find a resource that returns the data we’re
looking for in a structured format like <a href="https://json.org/">JSON</a>.</p>
<p><img alt="" src="../imgs/json-format.png" /></p>
<p>This is useful because it is very easy to convert data from JSON into a
spreadsheet type format — like a csv or Excel file.</p>
<h3 id="examine-the-websites-structure">Examine the website’s structure</h3>
<p>The basic strategy is pretty much the same for most scraping projects.
We will use our web browser (Chrome or Firefox recommended) to examine
the page you wish to retrieve data from, and copy/paste information from
your web browser into your scraping program.</p>
<p>We start by opening the collections web page in a web browser and
inspecting it.</p>
<p><img alt="" src="../imgs/dev_tools.png" /></p>
<p><img alt="" src="../imgs/dev_tools_pane.png" /></p>
<p>If we scroll down to the bottom of the Collections page, we’ll see a
button that says “Load More”. Let’s see what happens when we click on
that button. To do so, click on “Network” in the developer tools window,
then click the “Load More Collections” button. You should see a list of
requests that were made as a result of clicking that button, as shown
below.</p>
<p><img alt="" src="../imgs/dev_tools_network.png" /></p>
<p>If we look at that second request, the one to a script named <code>browse</code>,
we’ll see that it returns all the information we need, in a convenient
format called <code>JSON</code>. All we need to retrieve collection data is to make
<code>GET</code> requests to <a href="https://www.harvardartmuseums.org/browse">https://www.harvardartmuseums.org/browse</a> with the
correct parameters.</p>
<h3 id="launch-jupyterlab">Launch JupyterLab</h3>
<ol>
<li>Start the <code>Anaconda Navigator</code> program</li>
<li>Click the <code>Launch</code> button under <code>Jupyter Lab</code></li>
<li>A browser window will open with your computer’s files listed on the
    left hand side of the page. Navigate to the folder called
    <code>PythonWebScrape</code> that you downloaded to your desktop and
    double-click on the folder</li>
<li>Within the <code>PythonWebScrape</code> folder, double-click on the file with
    the word “BLANK” in the name (<code>PythonWebScrape_BLANK.ipynb</code>). A
    pop-up window will ask you to <code>Select Kernal</code> — you should select
    the Python 3 kernal. The Jupyter Notebook should now open on the
    right hand side of the page</li>
</ol>
<p>A Jupyter Notebook contains one or more <em>cells</em> containing notes or
code. To insert a new cell click the <code>+</code> button in the upper left. To
execute a cell, select it and press <code>Control+Enter</code> or click the <code>Run</code>
button at the top.</p>
<h3 id="making-requests">Making requests</h3>
<p>To retrieve information from the website (i.e., make a request), we need
to know the location of the information we want to collect. The Uniform
Resource Locator (URL) — commonly know as a “web address”, specifies the
location of a resource (such as a web page) on the internet.</p>
<p>A URL is usually composed of 5 parts:</p>
<p><img alt="" src="../imgs/URL.png" /></p>
<p>The 4th part, the “query string”, contains one or more <strong>parameters</strong>.
The 5th part, the “fragment”, is an internal page reference and may not
be present.</p>
<p>For example, the URL we want to retrieve data from has the following
structure:</p>
<pre><code>protocol                    domain    path  parameters
   https www.harvardartmuseums.org  browse  load_amount=10&amp;offset=0
</code></pre>
<p>It is often convenient to create variables containing the domain(s) and
path(s) you’ll be working with, as this allows you to swap out paths and
parameters as needed. Note that the path is separated from the domain
with <code>/</code> and the parameters are separated from the path with <code>?</code>. If
there are multiple parameters they are separated from each other with a
<code>&amp;</code>.</p>
<p>For example, we can define the domain and path of the collections URL as
follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">museum_domain</span> <span class="o">=</span> <span class="s1">&#39;https://www.harvardartmuseums.org&#39;</span>
<span class="n">collection_path</span> <span class="o">=</span> <span class="s1">&#39;browse&#39;</span>

<span class="n">collection_url</span> <span class="o">=</span> <span class="p">(</span><span class="n">museum_domain</span>
                  <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                  <span class="o">+</span> <span class="n">collection_path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">collection_url</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 'https://www.harvardartmuseums.org/browse'
</code></pre>
<p>Note that we omit the parameters here because it is usually easier to
pass them as a <code>dict</code> when using the <code>requests</code> library in Python. This
will become clearer shortly.</p>
<p>Now that we’ve constructed the URL we wish to interact with, we’re ready
to make our first request in Python.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">collections1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">collection_url</span><span class="p">,</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;load_amount&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;offset&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<p>Note that the parameters <code>load_amount</code> and <code>offset</code> are essentially
another way of setting page numbers — they refer to the amount of
information retrieved at one time and the starting position,
respectively.</p>
<h3 id="parsing-json-data">Parsing JSON data</h3>
<p>We already know from inspecting network traffic in our web browser that
this URL returns JSON, but we can use Python to verify this assumption.</p>
<div class="highlight"><pre><span></span><code><span class="n">collections1</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span>
</code></pre></div>
<pre><code>## 'application/json'
</code></pre>
<p>Since JSON is a structured data format, parsing it into Python data
structures is easy. In fact, there’s a method for that!</p>
<div class="highlight"><pre><span></span><code><span class="n">collections1</span> <span class="o">=</span> <span class="n">collections1</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="c1"># print(collections1)</span>
</code></pre></div>
<p>That’s it. Really, we are done here. Everyone go home!</p>
<p>OK not really, there is still more we can learn. But you have to admit
that was pretty easy. If you can identify a service that returns the
data you want in structured from, web scraping becomes a pretty trivial
enterprise. We’ll discuss several other scenarios and topics, but for
some web scraping tasks this is really all you need to know.</p>
<h3 id="organizing-saving-the-data">Organizing &amp; saving the data</h3>
<p>The records we retrieved from <a href="https://www.harvardartmuseums.org/browse">https://www.harvardartmuseums.org/browse</a>
are arranged as a list of dictionaries. We can easily select the fields
of arrange these data into a pandas <code>DataFrame</code> to facilitate subsequent
analysis.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">records1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">collections1</span><span class="p">[</span><span class="s1">&#39;records&#39;</span><span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">records1</span><span class="p">)</span>
</code></pre></div>
<pre><code>##                        copyright  contextualtextcount  ...                     dimensions                        seeAlso
## 0                           None                    0  ...  18.5 x 25.5 cm (7 5/16 x 1...  [{'id': 'https://iiif.harv...
## 1                           None                    0  ...  17.8 x 14.6 cm (7 x 5 3/4 ...  [{'id': 'https://iiif.harv...
## 2                           None                    0  ...  H. 17.7 x W. 11.0 x D. 9.0...  [{'id': 'https://iiif.harv...
## 3                           None                    0  ...  image: 21 x 27.6 cm (8 1/4...  [{'id': 'https://iiif.harv...
## 4                           None                    0  ...  image: 33 x 25 cm (13 x 9 ...  [{'id': 'https://iiif.harv...
## 5            © William Kentridge                    0  ...  plate: 24.5 x 37.7 cm (9 5...  [{'id': 'https://iiif.harv...
## 6                           None                    0  ...  257.98 g\r\n13.2 × 9.7 cm ...  [{'id': 'https://iiif.harv...
## 7  © Artists Rights Society (...                    0  ...  sheet: 34.5 x 37 cm (13 9/...  [{'id': 'https://iiif.harv...
## 8                           None                    0  ...  16.8 x 26.7 cm (6 5/8 x 10...  [{'id': 'https://iiif.harv...
## 9                           None                    0  ...  paintings proper: H. 145.5...  [{'id': 'https://iiif.harv...
## 
## [10 rows x 62 columns]
</code></pre>
<p>and write the data to a file.</p>
<div class="highlight"><pre><span></span><code><span class="n">records1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;records1.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="iterating-to-retrieve-all-the-data">Iterating to retrieve all the data</h3>
<p>Of course we don’t want just the first page of collections. How can we
retrieve all of them?</p>
<p>Now that we know the web service works, and how to make requests in
Python, we can iterate in the usual way.</p>
<div class="highlight"><pre><span></span><code><span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">param_values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;load_amount&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">:</span> <span class="n">offset</span><span class="p">}</span>
    <span class="n">current_request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">collection_url</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">)</span>
    <span class="n">records</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">current_request</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;records&#39;</span><span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">## convert list of dicts to a `DataFrame`</span>
<span class="n">records_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># write the data to a file.</span>
<span class="n">records_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;records_final.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">records_final</span><span class="p">)</span>
</code></pre></div>
<pre><code>##                         copyright  contextualtextcount  ...                        seeAlso                        details
## 0                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 1                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 2                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 3                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 4                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 5             © William Kentridge                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 6                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 7   © Artists Rights Society (...                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 8                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 9                            None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 10                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 11                           None                    0  ...  [{'id': 'https://iiif.harv...  {'coins': {'reverseinscrip...
## 12                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 13  \r\n© Vija Celmins, Courte...                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 14                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 15                           None                    1  ...  [{'id': 'https://iiif.harv...                            NaN
## 16                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 17                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 18                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 19  © Sarah Jane Roszak / Arti...                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 20                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 21                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 22                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 23  © Jenny Holzer / Artists R...                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 24                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 25                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 26                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 27                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 28                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 29                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 30                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 31                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 32                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 33                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 34                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 35                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 36               © Gary Schneider                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 37                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 38              © 1974 Mimi Smith                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 39                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 40                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 41                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 42                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 43                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 44                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 45                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 46                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 47   © Andy Warhol Foundation ...                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 48                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 49                           None                    0  ...  [{'id': 'https://iiif.harv...                            NaN
## 
## [50 rows x 63 columns]
</code></pre>
<h3 id="exercise-0">Exercise 0</h3>
<p><strong>Retrieve exhibits data</strong></p>
<p>In this exercise you will retrieve information about the art exhibitions
at Harvard Art Museums from
<a href="https://www.harvardartmuseums.org/exhibitions">https://www.harvardartmuseums.org/exhibitions</a></p>
<ol>
<li>Using a web browser (Firefox or Chrome recommended) inspect the page
    at <a href="https://www.harvardartmuseums.org/exhibitions">https://www.harvardartmuseums.org/exhibitions</a>. Examine the
    network traffic as you interact with the page. Try to find where the
    data displayed on that page comes from.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<ol>
<li>Make a <code>get</code> request in Python to retrieve the data from the URL
    identified in step1.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<ol>
<li>Write a <em>loop</em> or <em>list comprehension</em> in Python to retrieve data
    for the first 5 pages of exhibitions data.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<ol>
<li>Bonus (optional): Convert the data you retrieved into a pandas
    <code>DataFrame</code> and save it to a <code>.csv</code> file.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<details>
<summary>
<span style="color:red"><b>Click for Exercise 0 Solution</b></span>
</summary>

<div class="alert alert-danger">

Question #1:

<div class="highlight"><pre><span></span><code><span class="n">museum_domain</span> <span class="o">=</span> <span class="s2">&quot;https://www.harvardartmuseums.org&quot;</span>
<span class="n">exhibit_path</span> <span class="o">=</span> <span class="s2">&quot;search/load_more&quot;</span>
<span class="n">exhibit_url</span> <span class="o">=</span> <span class="n">museum_domain</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">exhibit_path</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exhibit_url</span><span class="p">)</span>
</code></pre></div>

    ## 'https://www.harvardartmuseums.org/search/load_more'

Question #2:

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span> <span class="k">as</span> <span class="nb">print</span> 
<span class="n">exhibit1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">exhibit_url</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;past-exhibition&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exhibit1</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">])</span>
</code></pre></div>

    ## 'application/json'

<div class="highlight"><pre><span></span><code><span class="n">exhibit1</span> <span class="o">=</span> <span class="n">exhibit1</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="c1"># print(exhibit1)</span>
</code></pre></div>

Questions #3+4 (loop solution):

<div class="highlight"><pre><span></span><code><span class="n">firstFivePages</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">records_per_page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">exhibit_url</span><span class="p">,</span> \
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;past-exhibition&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="n">page</span><span class="p">})</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;records&#39;</span><span class="p">]</span>
    <span class="n">firstFivePages</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">records_per_page</span><span class="p">)</span>
<span class="n">firstFivePages_records</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">firstFivePages</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">firstFivePages_records</span><span class="p">)</span>
</code></pre></div>

    ##                  shortdescription                         images  ...                         videos                   publications
    ## 0                            None  [{'date': '2018-08-03', 'c...  ...                            NaN                            NaN
    ## 1                            None  [{'date': '2018-01-12', 'c...  ...  [{'description': 'Bauhaus ...  [{'publicationplace': 'Cam...
    ## 2                            None  [{'date': '2019-01-22', 'c...  ...                            NaN                            NaN
    ## 3                            None  [{'date': None, 'copyright...  ...                            NaN                            NaN
    ## 4                            None  [{'date': '2018-11-09', 'c...  ...                            NaN                            NaN
    ## 5                            None  [{'date': '2018-06-04', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 6                            None  [{'date': '2001-03-01', 'c...  ...                            NaN                            NaN
    ## 7                            None  [{'date': '2005-04-18', 'c...  ...                            NaN                            NaN
    ## 8                            None  [{'date': '2018-06-29', 'c...  ...  [{'description': 'Marina I...                            NaN
    ## 9                            None  [{'date': '2018-03-15', 'c...  ...                            NaN                            NaN
    ## 10                           None  [{'date': '2016-10-17', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 11                           None  [{'date': '2017-02-16', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 12                           None  [{'date': '2018-01-23', 'c...  ...                            NaN                            NaN
    ## 13                           None  [{'date': '2001-04-01', 'c...  ...                            NaN                            NaN
    ## 14                           None  [{'date': '2016-06-10', 'c...  ...  [{'description': 'Fernando...                            NaN
    ## 15                           None  [{'date': '2008-10-27', 'c...  ...                            NaN                            NaN
    ## 16                           None  [{'date': '2017-10-05', 'c...  ...                            NaN                            NaN
    ## 17                           None  [{'date': '2002-05-01', 'c...  ...                            NaN                            NaN
    ## 18                           None  [{'date': '2007-08-01', 'c...  ...                            NaN                            NaN
    ## 19                           None  [{'date': '2003-03-21', 'c...  ...                            NaN                            NaN
    ## 20                           None  [{'date': '2017-05-08', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 21                           None  [{'date': '2002-08-01', 'c...  ...  [{'description': 'Symposiu...                            NaN
    ## 22                           None  [{'date': '2016-07-05', 'c...  ...                            NaN                            NaN
    ## 23                           None  [{'date': '2017-03-29', 'c...  ...                            NaN                            NaN
    ## 24                           None  [{'date': '2015-03-22', 'c...  ...  [{'description': 'The Phil...  [{'publicationplace': 'Cam...
    ## 25                           None  [{'date': '2017-03-07', 'c...  ...                            NaN                            NaN
    ## 26  Harvard professor Ewa Laje...  [{'date': '2001-03-01', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 27  This exhibition features w...  [{'date': '2016-07-12', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 28                           None  [{'date': '2017-02-08', 'c...  ...                            NaN                            NaN
    ## 29                           None  [{'date': '2001-06-01', 'c...  ...                            NaN                            NaN
    ## 30                           None  [{'date': '2005-11-03', 'c...  ...                            NaN                            NaN
    ## 31                           None  [{'date': '2015-04-06', 'c...  ...  [{'description': 'Wolfgang...                            NaN
    ## 32                    In progress  [{'date': '2016-07-28', 'c...  ...                            NaN                            NaN
    ## 33                           None  [{'date': None, 'copyright...  ...                            NaN                            NaN
    ## 34                           None  [{'date': '2016-03-21', 'c...  ...                            NaN                            NaN
    ## 35                           None  [{'date': '2007-04-18', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 36                           None  [{'date': '2015-04-01', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 37                           None  [{'date': '2016-01-12', 'c...  ...                            NaN                            NaN
    ## 38                           None  [{'date': '2002-07-01', 'c...  ...                            NaN                            NaN
    ## 39                           None  [{'date': '2007-02-27', 'c...  ...                            NaN                            NaN
    ## 40                           None  [{'date': '2006-01-18', 'c...  ...                            NaN                            NaN
    ## 41                           None  [{'date': '2015-10-29', 'c...  ...                            NaN                            NaN
    ## 42                           None  [{'date': '2014-08-12', 'c...  ...  [{'description': 'Teaser: ...  [{'publicationplace': 'Cam...
    ## 43                           None  [{'date': '2005-11-03', 'c...  ...                            NaN                            NaN
    ## 44                           None  [{'date': '1989-08-01', 'c...  ...                            NaN                            NaN
    ## 45  This multi-component insta...  [{'date': '2014-03-31', 'c...  ...                            NaN                            NaN
    ## 46                           None  [{'date': '2009-11-30', 'c...  ...                            NaN                            NaN
    ## 47  Harvard Art Museums’ new p...  [{'date': '2012-06-29', 'c...  ...  [{'description': 'Terry Wi...                            NaN
    ## 48                           None  [{'date': '2014-11-10', 'c...  ...                            NaN                            NaN
    ## 49  In the Japanese context, a...  [{'date': '2012-07-17', 'c...  ...                            NaN                            NaN
    ## 
    ## [50 rows x 19 columns]

Questions #3+4 (list comprehension solution):

<div class="highlight"><pre><span></span><code><span class="n">first5Pages</span> <span class="o">=</span> <span class="p">[</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">exhibit_url</span><span class="p">,</span> \
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;past-exhibition&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="n">page</span><span class="p">})</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;records&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="n">first5Pages</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">first5Pages</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">first5Pages_records</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">first5Pages</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first5Pages_records</span><span class="p">)</span>
</code></pre></div>

    ##                  shortdescription                         images  ...                         videos                   publications
    ## 0                            None  [{'date': '2018-08-03', 'c...  ...                            NaN                            NaN
    ## 1                            None  [{'date': '2018-01-12', 'c...  ...  [{'description': 'Bauhaus ...  [{'publicationplace': 'Cam...
    ## 2                            None  [{'date': '2019-01-22', 'c...  ...                            NaN                            NaN
    ## 3                            None  [{'date': None, 'copyright...  ...                            NaN                            NaN
    ## 4                            None  [{'date': '2018-11-09', 'c...  ...                            NaN                            NaN
    ## 5                            None  [{'date': '2018-06-04', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 6                            None  [{'date': '2001-03-01', 'c...  ...                            NaN                            NaN
    ## 7                            None  [{'date': '2005-04-18', 'c...  ...                            NaN                            NaN
    ## 8                            None  [{'date': '2018-06-29', 'c...  ...  [{'description': 'Marina I...                            NaN
    ## 9                            None  [{'date': '2018-03-15', 'c...  ...                            NaN                            NaN
    ## 10                           None  [{'date': '2016-10-17', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 11                           None  [{'date': '2017-02-16', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 12                           None  [{'date': '2018-01-23', 'c...  ...                            NaN                            NaN
    ## 13                           None  [{'date': '2001-04-01', 'c...  ...                            NaN                            NaN
    ## 14                           None  [{'date': '2016-06-10', 'c...  ...  [{'description': 'Fernando...                            NaN
    ## 15                           None  [{'date': '2008-10-27', 'c...  ...                            NaN                            NaN
    ## 16                           None  [{'date': '2017-10-05', 'c...  ...                            NaN                            NaN
    ## 17                           None  [{'date': '2002-05-01', 'c...  ...                            NaN                            NaN
    ## 18                           None  [{'date': '2007-08-01', 'c...  ...                            NaN                            NaN
    ## 19                           None  [{'date': '2003-03-21', 'c...  ...                            NaN                            NaN
    ## 20                           None  [{'date': '2017-05-08', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 21                           None  [{'date': '2002-08-01', 'c...  ...  [{'description': 'Symposiu...                            NaN
    ## 22                           None  [{'date': '2016-07-05', 'c...  ...                            NaN                            NaN
    ## 23                           None  [{'date': '2017-03-29', 'c...  ...                            NaN                            NaN
    ## 24                           None  [{'date': '2015-03-22', 'c...  ...  [{'description': 'The Phil...  [{'publicationplace': 'Cam...
    ## 25                           None  [{'date': '2017-03-07', 'c...  ...                            NaN                            NaN
    ## 26  Harvard professor Ewa Laje...  [{'date': '2001-03-01', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 27  This exhibition features w...  [{'date': '2016-07-12', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 28                           None  [{'date': '2017-02-08', 'c...  ...                            NaN                            NaN
    ## 29                           None  [{'date': '2001-06-01', 'c...  ...                            NaN                            NaN
    ## 30                           None  [{'date': '2005-11-03', 'c...  ...                            NaN                            NaN
    ## 31                           None  [{'date': '2015-04-06', 'c...  ...  [{'description': 'Wolfgang...                            NaN
    ## 32                    In progress  [{'date': '2016-07-28', 'c...  ...                            NaN                            NaN
    ## 33                           None  [{'date': None, 'copyright...  ...                            NaN                            NaN
    ## 34                           None  [{'date': '2016-03-21', 'c...  ...                            NaN                            NaN
    ## 35                           None  [{'date': '2007-04-18', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 36                           None  [{'date': '2015-04-01', 'c...  ...                            NaN  [{'publicationplace': 'Cam...
    ## 37                           None  [{'date': '2016-01-12', 'c...  ...                            NaN                            NaN
    ## 38                           None  [{'date': '2002-07-01', 'c...  ...                            NaN                            NaN
    ## 39                           None  [{'date': '2007-02-27', 'c...  ...                            NaN                            NaN
    ## 40                           None  [{'date': '2006-01-18', 'c...  ...                            NaN                            NaN
    ## 41                           None  [{'date': '2015-10-29', 'c...  ...                            NaN                            NaN
    ## 42                           None  [{'date': '2014-08-12', 'c...  ...  [{'description': 'Teaser: ...  [{'publicationplace': 'Cam...
    ## 43                           None  [{'date': '2005-11-03', 'c...  ...                            NaN                            NaN
    ## 44                           None  [{'date': '1989-08-01', 'c...  ...                            NaN                            NaN
    ## 45  This multi-component insta...  [{'date': '2014-03-31', 'c...  ...                            NaN                            NaN
    ## 46                           None  [{'date': '2009-11-30', 'c...  ...                            NaN                            NaN
    ## 47  Harvard Art Museums’ new p...  [{'date': '2012-06-29', 'c...  ...  [{'description': 'Terry Wi...                            NaN
    ## 48                           None  [{'date': '2014-11-10', 'c...  ...                            NaN                            NaN
    ## 49  In the Japanese context, a...  [{'date': '2012-07-17', 'c...  ...                            NaN                            NaN
    ## 
    ## [50 rows x 19 columns]

</div>

</details>

<h2 id="parsing-html-if-you-have-to">Parsing HTML if you have to</h2>
<div class="alert alert-info">

**GOAL: To retrieve information in HTML format and organize it into a
spreadsheet.**

1.  Make a request to the website server to retrieve the HTML
2.  Inspect the HTML to determine the XPATHs that point to the data we
    want
3.  Extract the information from the location the XPATHs point to and
    store in a dictionary
4.  Convert from a dictionary to a .csv file

</div>

<p>As we’ve seen, you can often inspect network traffic or other sources to
locate the source of the data you are interested in and the API used to
retrieve it. You should always start by looking for these shortcuts and
using them where possible. If you are really lucky, you’ll find a
shortcut that returns the data as JSON. If you are not quite so lucky,
you will have to parse HTML to retrieve the information you need.</p>
<h3 id="document-object-model-dom">Document Object Model (DOM)</h3>
<p>To parse HTML, we need to have a nice tree structure that contains the
whole HTML file through which we can locate the information. This
tree-like structure is the <strong>Document Object Model (DOM)</strong>. DOM is a
cross-platform and language-independent interface that treats an XML or
HTML document as a tree structure wherein each node is an object
representing a part of the document. The DOM represents a document with
a logical tree. <em>Each branch of the tree ends in a node, and each node
contains objects</em>. DOM methods allow programmatic access to the tree;
with them one can change the structure, style or content of a document.
The following is an example of DOM hierarchy in an HTML document:</p>
<p><img alt="" src="../imgs/DOM.png" /></p>
<h3 id="retrieving-html">Retrieving HTML</h3>
<p>When I inspect the network traffic while interacting with
<a href="https://www.harvardartmuseums.org/calendar">https://www.harvardartmuseums.org/calendar</a> I don’t see any requests
that return JSON data. The best we can do appears to be to return HTML.</p>
<p>To retrieve data on the events listed in the calender, the first step is
the same as before: we make a <code>get</code> request.</p>
<div class="highlight"><pre><span></span><code><span class="n">calendar_path</span> <span class="o">=</span> <span class="s1">&#39;calendar&#39;</span>

<span class="n">calendar_url</span> <span class="o">=</span> <span class="p">(</span><span class="n">museum_domain</span> <span class="c1"># recall that we defined museum_domain earlier</span>
                  <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                  <span class="o">+</span> <span class="n">calendar_path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">calendar_url</span><span class="p">)</span>
</code></pre></div>
<pre><code>## 'https://www.harvardartmuseums.org/calendar'
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">events</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">calendar_url</span><span class="p">)</span>
</code></pre></div>
<p>As before, we can check the headers to see what type of content we
received in response to our request.</p>
<div class="highlight"><pre><span></span><code><span class="n">events</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span>
</code></pre></div>
<pre><code>## 'text/html; charset=UTF-8'
</code></pre>
<h3 id="parsing-html-using-the-lxml-library">Parsing HTML using the lxml library</h3>
<p>Like JSON, HTML is structured; unlike JSON, it is designed to be
rendered into a human-readable page rather than simply to store and
exchange data in a computer-readable format. Consequently, parsing HTML
and extracting information from it is somewhat more difficult than
parsing JSON.</p>
<p>While JSON parsing is built into the Python <code>requests</code> library, parsing
HTML requires a separate library. I recommend using the HTML parser from
the <code>lxml</code> library; others prefer an alternative called
<code>beautifulsoup4</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">html</span>

<span class="c1"># convert a html text representation (`events.text`) into </span>
<span class="c1"># a tree-structure (DOM) html representation (`events_html`)</span>
<span class="n">events_html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
<h3 id="using-xpath-to-extract-content-from-html">Using XPath to extract content from HTML</h3>
<p><code>XPath</code> is a tool for identifying particular elements within a HTML
document. The developer tools built into modern web browsers make it
easy to generate <code>XPath</code>s that can be used to identify the elements of a
web page that we wish to extract.</p>
<p>We can open the HTML document we retrieved and inspect it using our web
browser.</p>
<div class="highlight"><pre><span></span><code><span class="n">html</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">events_html</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../imgs/dev_tools_right_click.png" /></p>
<p><img alt="" src="../imgs/dev_tools_inspect.png" /></p>
<p>Once we identify the element containing the information of interest we
can use our web browser to copy the <code>XPath</code> that uniquely identifies
that element.</p>
<p><img alt="" src="../imgs/dev_tools_xpath.png" /></p>
<p>Next we can use Python to extract the element of interest:</p>
<div class="highlight"><pre><span></span><code><span class="n">events_list_html</span> <span class="o">=</span> <span class="n">events_html</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&quot;events_list&quot;]/article&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Let’s just extract the second element in our events list.</p>
<div class="highlight"><pre><span></span><code><span class="n">second_event_html</span> <span class="o">=</span> <span class="n">events_list_html</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
<p>Once again, we can use a web browser to inspect the HTML we’re currently
working with - from the second event - and to figure out what we want to
extract from it.</p>
<div class="highlight"><pre><span></span><code><span class="n">html</span><span class="o">.</span><span class="n">open_in_browser</span><span class="p">(</span><span class="n">second_event_html</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</code></pre></div>
<p>As before, we can use our browser to find the xpath of the elements we
want.</p>
<p><img alt="" src="../imgs/dev_tools_figcaption.png" /></p>
<p>(Note that the <code>html.open_in_browser</code> function adds enclosing <code>html</code> and
<code>body</code> tags in order to create a complete web page for viewing. This
requires that we adjust the <code>xpath</code> accordingly.)</p>
<p>By repeating this process for each element we want, we can build a list
of the xpaths to those elements.</p>
<div class="highlight"><pre><span></span><code><span class="n">elements_we_want</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;figcaption&#39;</span><span class="p">:</span> <span class="s1">&#39;div/figure/div/figcaption&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;div/div/header/time&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;div/div/header/h2/a&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;div/div/div/p[1]/time&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;div/div/div/p[3]&#39;</span>
                    <span class="p">}</span>
</code></pre></div>
<p>Finally, we can iterate over the elements we want and extract them.</p>
<div class="highlight"><pre><span></span><code><span class="n">second_event_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">elements_we_want</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">element</span> <span class="o">=</span> <span class="n">second_event_html</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">elements_we_want</span><span class="p">[</span><span class="n">key</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">second_event_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">text_content</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">second_event_values</span><span class="p">)</span>
</code></pre></div>
<pre><code>## {'date': 'Wednesday, February 23, 2022',
##  'description': 'Virtual gallery tours are designed especially for our Friends '
##                 'and Fellows and are led by our curators, fellows, and other '
##                 'specialists.',
##  'figcaption': 'Photo: Kate Smith.',
##  'time': '9:30am - 10:30am',
##  'title': 'Virtual Gallery Tour for Friends and Fellows of the Museums'}
</code></pre>
<h3 id="iterating-to-retrieve-content-from-a-list-of-html-elements">Iterating to retrieve content from a list of HTML elements</h3>
<p>So far we’ve retrieved information only for the second event. To
retrieve data for all the events listed on the page we need to iterate
over the events. If we are very lucky, each event will have exactly the
same information structured in exactly the same way and we can simply
extend the code we wrote above to iterate over the events list.</p>
<p>Unfortunately, not all these elements are available for every event, so
we need to take care to handle the case where one or more of these
elements is not available. We can do that by <strong>defining a function</strong>
that tries to retrieve a value and returns an empty string if it fails.</p>
<p>If you’re not familiar with Python functions, here’s the basic syntax:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># anatomy of a function</span>

<span class="k">def</span> <span class="nf">name_of_function</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="n">argn</span><span class="p">):</span>  <span class="c1"># define the function name and arguments</span>
    <span class="o">&lt;</span><span class="n">body</span> <span class="n">of</span> <span class="n">function</span><span class="o">&gt;</span>   <span class="c1"># specify calculations</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="n">result</span><span class="o">&gt;</span>      <span class="c1"># output result of calculations</span>
</code></pre></div>
<p>Here’s an example of a simple function:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">square_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># exponentiation</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="n">square_fun</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>    
</code></pre></div>
<pre><code>## 16
</code></pre>
<p>Here’s a function to perform our actual task:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_event_info</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text_content</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="n">info</span>
</code></pre></div>
<p>Armed with this function, we can iterate over the list of events and
extract the available information for each one.</p>
<div class="highlight"><pre><span></span><code><span class="n">all_event_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">elements_we_want</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">key_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events_list_html</span><span class="p">:</span> 
        <span class="n">key_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_event_info</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">elements_we_want</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
    <span class="n">all_event_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_values</span>
</code></pre></div>
<p>For convenience we can arrange these values in a pandas <code>DataFrame</code> and
save them as .csv files, just as we did with our exhibitions data
earlier.</p>
<div class="highlight"><pre><span></span><code><span class="n">all_event_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">all_event_values</span><span class="p">)</span>

<span class="n">all_event_values</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;all_event_values.csv&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">all_event_values</span><span class="p">)</span>
</code></pre></div>
<h3 id="exercise-1">Exercise 1</h3>
<p><strong>parsing HTML</strong></p>
<p>In this exercise you will retrieve information about the physical layout
of the Harvard Art Museums. The web page at
<a href="https://www.harvardartmuseums.org/visit/floor-plan">https://www.harvardartmuseums.org/visit/floor-plan</a> contains this
information in HTML from.</p>
<ol>
<li>
<p>Using a web browser (Firefox or Chrome recommended) inspect the page
    at <a href="https://www.harvardartmuseums.org/visit/floor-plan">https://www.harvardartmuseums.org/visit/floor-plan</a>. Copy the
    <code>XPath</code> to the element containing the list of level information.
    (HINT: the element if interest is a <code>ul</code>, i.e., <code>unordered list</code>.)</p>
</li>
<li>
<p>Make a <code>get</code> request in Python to retrieve the web page at
    <a href="https://www.harvardartmuseums.org/visit/floor-plan">https://www.harvardartmuseums.org/visit/floor-plan</a>. Extract the
    content from your request object and parse it using
    <code>html.fromstring</code> from the <code>lxml</code> library.</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<ol>
<li>Use your web browser to find the <code>XPath</code>s to the facilities housed
    on level one. Use Python to extract the text from those <code>Xpath</code>s.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<ol>
<li>Bonus (optional): Write a <em>for loop</em> or <em>list comprehension</em> in
    Python to retrieve data for all the levels.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">##</span>
</code></pre></div>
<details>
<summary>
<span style="color:red"><b>Click for Exercise 1 Solution</b></span>
</summary>

<div class="alert alert-danger">

Question #2:

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">html</span>
<span class="n">floor_plan</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://www.harvardartmuseums.org/visit/floor-plan&#39;</span><span class="p">)</span>
<span class="n">floor_plan_html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">floor_plan</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>

Question #3:

<div class="highlight"><pre><span></span><code><span class="n">level_one</span> <span class="o">=</span> <span class="n">floor_plan_html</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/main/section/ul/li[5]/div[2]/ul&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">level_one</span><span class="p">))</span>
</code></pre></div>

    ## <class 'lxml.html.HtmlElement'>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">level_one</span><span class="p">))</span>
</code></pre></div>

    ## 6

<div class="highlight"><pre><span></span><code><span class="n">level_one_facilities</span> <span class="o">=</span> <span class="n">floor_plan_html</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/main/section/ul/li[5]/div[2]/ul/li&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">level_one_facilities</span><span class="p">))</span>
</code></pre></div>

    ## 6

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">([</span><span class="n">facility</span><span class="o">.</span><span class="n">text_content</span><span class="p">()</span> <span class="k">for</span> <span class="n">facility</span> <span class="ow">in</span> <span class="n">level_one_facilities</span><span class="p">])</span>
</code></pre></div>

    ## ['Admissions', 'Collection Galleries', 'Courtyard', 'Shop', 'Café', 'Coatroom']

Question #4:

<div class="highlight"><pre><span></span><code><span class="n">all_levels</span> <span class="o">=</span> <span class="n">floor_plan_html</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/main/section/ul/li&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_levels</span><span class="p">))</span>
</code></pre></div>

    ## 6

<div class="highlight"><pre><span></span><code><span class="n">all_levels_facilities</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">all_levels</span><span class="p">:</span>
    <span class="n">level_facilities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">level_facilities_collection</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;div[2]/ul/li&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">level_facility</span> <span class="ow">in</span> <span class="n">level_facilities_collection</span><span class="p">:</span>
        <span class="n">level_facilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level_facility</span><span class="o">.</span><span class="n">text_content</span><span class="p">())</span>
    <span class="n">all_levels_facilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level_facilities</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_levels_facilities</span><span class="p">)</span>
</code></pre></div>

    ## [['Conservation Center / Lightbox Gallery'],
    ##  ['Art Study Center'],
    ##  ['Collection Galleries',
    ##   'Special Exhibitions Gallery',
    ##   'University Galleries'],
    ##  ['Collections Galleries'],
    ##  ['Admissions',
    ##   'Collection Galleries',
    ##   'Courtyard',
    ##   'Shop',
    ##   'Café',
    ##   'Coatroom'],
    ##  ['Lower Lobby',
    ##   'Lecture Halls',
    ##   'Seminar Room',
    ##   'Materials Lab',
    ##   'Coatroom',
    ##   'Offices']]

</div>

</details>

<h2 id="scrapy-for-large-complex-projects"><code>Scrapy</code>: for large / complex projects</h2>
<p>Scraping websites using the <code>requests</code> library to make GET and POST
requests, and the <code>lxml</code> library to process HTML is a good way to learn
basic web scraping techniques. It is a good choice for small to medium
size projects. For very large or complicated scraping tasks the <code>scrapy</code>
library offers a number of conveniences, including asynchronous
retrieval, session management, convenient methods for extracting and
storing values, and more. More information about <code>scrapy</code> can be found
at <a href="https://doc.scrapy.org">https://doc.scrapy.org</a>.</p>
<h2 id="browser-drivers-a-last-resort">Browser drivers: a last resort</h2>
<p>It is sometimes necessary (or sometimes just easier) to use a web
browser as an intermediary rather than communicate directly with a web
service. This method of using a “browser driver” has the advantage of
being able to use the javascript engine and session management features
of a web browser; the main disadvantage is that it is slower and tends
to be more fragile than using <code>requests</code> or <code>scrapy</code> to make requests
directly from Python. For small scraping projects involving complicated
sites with CAPTHAs or lots of complicated javascript using a browser
driver can be a good option. More information is available at
<a href="https://www.seleniumhq.org/docs/03_webdriver.jsp">https://www.seleniumhq.org/docs/03_webdriver.jsp</a>.</p>
<h2 id="wrap-up">Wrap-up</h2>
<h3 id="feedback">Feedback</h3>
<p>These workshops are a work in progress, please provide any feedback to:
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#104;&#101;&#108;&#112;&#64;&#105;&#113;&#46;&#104;&#97;&#114;&#118;&#97;&#114;&#100;&#46;&#101;&#100;&#117;">&#104;&#101;&#108;&#112;&#64;&#105;&#113;&#46;&#104;&#97;&#114;&#118;&#97;&#114;&#100;&#46;&#101;&#100;&#117;</a></p>
<h3 id="resources">Resources</h3>
<ul>
<li>IQSS<ul>
<li>Workshops:
    <a href="https://www.iq.harvard.edu/data-science-services/workshop-materials">https://www.iq.harvard.edu/data-science-services/workshop-materials</a></li>
<li>Data Science Services:
    <a href="https://www.iq.harvard.edu/data-science-services">https://www.iq.harvard.edu/data-science-services</a></li>
<li>Research Computing Environment:
    <a href="https://iqss.github.io/dss-rce/">https://iqss.github.io/dss-rce/</a></li>
</ul>
</li>
<li>HBS<ul>
<li>Research Computing Services workshops:
    <a href="https://training.rcs.hbs.org/workshops">https://training.rcs.hbs.org/workshops</a></li>
<li>Other HBS RCS resources:
    <a href="https://training.rcs.hbs.org/workshop-materials">https://training.rcs.hbs.org/workshop-materials</a></li>
<li>RCS consulting email:
    <a href="mailto:research@hbs.edu" class="uri">mailto:research<a class="gh-link gh-mention" href="https://github.com/hbs" title="GitHub User: @hbs">@hbs</a>.edu</a></li>
</ul>
</li>
</ul>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../large_data_R/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Large data in R" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Large data in R
            </div>
          </div>
        </a>
      
      
        
        <a href="../nlp_with_python/" class="md-footer__link md-footer__link--next" aria-label="Next: NLP in Python" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              NLP in Python
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; President & Fellows of Harvard College.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.092fa1f6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a9542cf.min.js"></script>
      
    
  </body>
</html>